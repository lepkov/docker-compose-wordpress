FROM mariadb:10.6

#RUN apt-get update -y && apt-get upgrade -y

# Update the MySQL configuration file
RUN echo "[mysqld]" >> /etc/mysql/conf.d/docker.cnf
RUN echo "character_set_server=utf8mb4" >> /etc/mysql/conf.d/docker.cnf
RUN echo "collation-server=utf8mb4_unicode_ci" >> /etc/mysql/conf.d/docker.cnf

# Turn on slow query catch
RUN echo "slow_query_log = 1" >> /etc/mysql/conf.d/docker.cnf
RUN echo "slow_query_log_file = /var/log/mysql/mariadb-slow.log" >> /etc/mysql/conf.d/docker.cnf
RUN echo "long_query_time = 1" >> /etc/mysql/conf.d/docker.cnf

# Optional: Set the time zone
ENV TZ=Europe/Moscow

# Set appropriate file permissions
RUN chown -R mysql:mysql /docker-entrypoint-initdb.d

# Start the MariaDB service
CMD ["mysqld"]
